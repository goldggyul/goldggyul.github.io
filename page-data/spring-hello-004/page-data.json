{"componentChunkName":"component---src-templates-blog-template-js","path":"/spring-hello-004/","result":{"data":{"cur":{"id":"a5a0379d-2a19-5ae9-bf12-22dfbe6f740a","html":"<blockquote>\n<p>본 게시글은 <a href=\"https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EC%9E%85%EB%AC%B8-%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/\">스프링 입문 - 코드로 배우는 스프링 부트, 웹 MVC, DB 접근 기술</a> 강의를 듣고 정리했습니다.</p>\n</blockquote>\n<h1 id=\"️-회원-관리-예제---웹-mvc-개발\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%ED%9A%8C%EC%9B%90-%EA%B4%80%EB%A6%AC-%EC%98%88%EC%A0%9C---%EC%9B%B9-mvc-%EA%B0%9C%EB%B0%9C\" aria-label=\"️ 회원 관리 예제   웹 mvc 개발 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>☘️ 회원 관리 예제 - 웹 MVC 개발</h1>\n<h2 id=\"-회원-웹-기능---홈-화면-추가\" style=\"position:relative;\"><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%ED%99%88-%ED%99%94%EB%A9%B4-%EC%B6%94%EA%B0%80\" aria-label=\" 회원 웹 기능   홈 화면 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 회원 웹 기능 - 홈 화면 추가</h2>\n<p>홈 화면을 추가해보자.</p>\n<ul>\n<li>\n<p>컨트롤러를 통해 홈 화면 html을 리턴할 것이므로 <code class=\"language-text\">src/main/resources/templates</code>에 home.html을 만들어주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>th</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.thymeleaf.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Hello Spring<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>회원 기능<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/members/new<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>회원 가입<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/members<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>회원 목록<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- /container --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>회원 가입과 회원 목록은 ~~/members/new 와 ~~/members로 이동하도록 연결해놨다. 아래에서 컨트롤러를 연결해주자.</li>\n</ul>\n</li>\n<li>\n<p>그리고 컨트롤러에서 home을 리턴해주자. 그럼 <u><strong>viewResolver가 templates에서 같은 이름의 파일을 찾고 필요하면 처리</strong></u>를 하고 내보내겠죠?</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HomeController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<p>어라라? 근데 이미 <code class=\"language-text\">static</code> 폴더에 <code class=\"language-text\">index.html</code>을 추가해놔서 welcome page로 home에선 해당 파일이 나오지 않았던가?</p>\n<ul>\n<li>하지만 스프링은 우선 컨트롤러를 찾고, 없으면 static에서 정적 파일을 찾는다. 이 경우 컨트롤러가 있으므로 정적 파일을 찾지 않는다.</li>\n</ul>\n<h2 id=\"-회원-웹-기능---등록\" style=\"position:relative;\"><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EB%93%B1%EB%A1%9D\" aria-label=\" 회원 웹 기능   등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 회원 웹 기능 - 등록</h2>\n<h3 id=\"회원가입-페이지와-컨트롤러\" style=\"position:relative;\"><a href=\"#%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85-%ED%8E%98%EC%9D%B4%EC%A7%80%EC%99%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\" aria-label=\"회원가입 페이지와 컨트롤러 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>회원가입 페이지와 컨트롤러</h3>\n<p>회원 가입을 누르면 ‘members/new’로 이동하게 되어 있었다.</p>\n<p>따라서 회원 가입 페이지와, 페이지를 연결해주는 컨트롤러를 만들자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/members/new\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">createForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"members/createMemberForm\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p>위 리턴되는 경로대로 templates에 members 디렉터리를 생성하고 createMemberForm.html을 만들자.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>th</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.thymeleaf.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/members/new<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>form-group<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>이름<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>이름을\n입력하세요<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>등록<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- /container --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n</li>\n<li>\n<p>이제 값(이름)을 받아와야 한다.</p>\n</li>\n<li>\n<p>그럼 우선 서버에 값이 어떻게 갈까?</p>\n<ul>\n<li>submit 버튼을 누르면 form 태그에 action에 적힌 url로 method 방식으로 요청이 간다.\n<ul>\n<li>따라서 이 경우에는 “members/new”로  POST 방식으로 요청이 간다.</li>\n</ul>\n</li>\n<li>input 태그를 보면 name이 “name”으로 되어 있다. 이게 서버로 넘어갈 때 key가 된다.</li>\n</ul>\n</li>\n<li>\n<p>그럼  “/members/new” url과 POST 맵핑된 컨트롤러를 만들고, 값을 받아올 때는  input의 name인 “name”과 필드 이름이 같은 객체를 파라미터로 받으면 된다. 그럼 스프링이 알아서 객체의 setter를 통해 값을 넣어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberForm</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>컨트롤러에서 성공적으로 가입 시킨 후에는 다시 홈으로 redirect 시켜주자.</p>\n</li>\n<li>\n<p>아직 뭔가 가입 후에 나오지 않지만, 중복되는 이름을 입력하면 그 전에 memberService에서 이름 체크하는 로직을 넣어놨으므로 에러가 발생한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ...</span>\n    <span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/members/new\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberForm</span> form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        memberService<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"redirect:/\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<h2 id=\"-회원-웹-기능---조회\" style=\"position:relative;\"><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EC%A1%B0%ED%9A%8C\" aria-label=\" 회원 웹 기능   조회 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 회원 웹 기능 - 조회</h2>\n<p>회원 목록에선 “members”로 이동하게 되어 있다.</p>\n<p>따라서 컨트롤러에서 “members”와 GetMapping시킨 후에, 컨트롤러에서는 service로부터 멤버를 받아오고 model에 담은 뒤에, 템플릿을 리턴하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ...</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/members\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Model</span> model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> members <span class=\"token operator\">=</span> memberService<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        model<span class=\"token punctuation\">.</span><span class=\"token function\">addAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"members\"</span><span class=\"token punctuation\">,</span> members<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"members/memberList\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>th</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.thymeleaf.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>thead</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>#<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>이름<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>thead</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>each</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>member : ${members}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>${member.id}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>${member.name}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- /container --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>모델에 멤버들 <code class=\"language-text\">List</code>를 넘겼다.</li>\n<li>그럼 타임리프 템플릿 엔진에서 넘어온 members 값을 보고, 루프를 돌면서 하나씩 실행해준다.</li>\n</ul>\n<p>실행해보면 헌재 메모리에 회원을 저장하므로 서버를 껐다 키면 당연히 다 날아간다.</p>\n<p>그럼 이제 데이터베이스에 저장해볼까요?</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-%ED%9A%8C%EC%9B%90-%EA%B4%80%EB%A6%AC-%EC%98%88%EC%A0%9C---%EC%9B%B9-mvc-%EA%B0%9C%EB%B0%9C\">☘️ 회원 관리 예제 - 웹 MVC 개발</a></p>\n<ul>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%ED%99%88-%ED%99%94%EB%A9%B4-%EC%B6%94%EA%B0%80\">📌 회원 웹 기능 - 홈 화면 추가</a></p>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EB%93%B1%EB%A1%9D\">📌 회원 웹 기능 - 등록</a></p>\n<ul>\n<li><a href=\"#%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85-%ED%8E%98%EC%9D%B4%EC%A7%80%EC%99%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\">회원가입 페이지와 컨트롤러</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EC%A1%B0%ED%9A%8C\">📌 회원 웹 기능 - 조회</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"본 게시글은 스프링 입문 - 코드로 배우는 스프링 부트, 웹 MVC, DB 접근 기술 강의를 듣고 정리했습니다. ☘️ 회원 관리 예제 - 웹 MVC 개발 📌 회원 웹 기능 - 홈 화면 추가 홈 화면을 추가해보자. 컨트롤러를 통해 홈 화면 html을 리턴할 것이므로 에 home.html을 만들어주자. 회원 가입과 회원 목록은 ~~/members/new 와 ~~/members로 이동하도록 연결해놨다. 아래에서 컨트롤러를 연결해주자. 그리고 컨트롤러에서 home을 리턴해주자. 그럼 viewResolver가 templates에서 같은 이름의 파일을 찾고 필요하면 처리를 하고 내보내겠죠? 어라라? 근데 이미  폴더에 을 추가해놔서 welcome page로 home에선 해당 파일이 나오지 않았던가? 하지만 스프링은 우선 컨트롤러를 찾고, 없으면 static에서 정적 파일을 찾는다. 이 경우 컨트롤러가 있으므로 정적 파일을 찾지 않는다. 📌 회원 웹 기능 - 등록 회원가입 페이지와 컨트롤러 회원…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-%ED%9A%8C%EC%9B%90-%EA%B4%80%EB%A6%AC-%EC%98%88%EC%A0%9C---%EC%9B%B9-mvc-%EA%B0%9C%EB%B0%9C\">☘️ 회원 관리 예제 - 웹 MVC 개발</a></p>\n<ul>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%ED%99%88-%ED%99%94%EB%A9%B4-%EC%B6%94%EA%B0%80\">📌 회원 웹 기능 - 홈 화면 추가</a></p>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EB%93%B1%EB%A1%9D\">📌 회원 웹 기능 - 등록</a></p>\n<ul>\n<li><a href=\"#%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85-%ED%8E%98%EC%9D%B4%EC%A7%80%EC%99%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\">회원가입 페이지와 컨트롤러</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%8C%EC%9B%90-%EC%9B%B9-%EA%B8%B0%EB%8A%A5---%EC%A1%B0%ED%9A%8C\">📌 회원 웹 기능 - 조회</a></p>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"date":"October 04, 2022","title":"회원 관리 예제 / 웹 MVC 개발 - 스프링 입문 | 매일 1시간 👨🏻‍🏫 4일차","categories":"강의","author":"goldggyul","emoji":null,"imageEmoji":"spring-boot-logo.png"},"fields":{"slug":"/spring-hello-004/"}},"next":{"id":"88cd5888-280c-5f11-b541-1ded4fa445bf","html":"<blockquote>\n<p>본 게시글은 <a href=\"https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EC%9E%85%EB%AC%B8-%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/\">스프링 입문 - 코드로 배우는 스프링 부트, 웹 MVC, DB 접근 기술</a> 강의를 듣고 정리했습니다.</p>\n</blockquote>\n<h1 id=\"️-스프링-빈과-의존-관계\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EA%B3%BC-%EC%9D%98%EC%A1%B4-%EA%B4%80%EA%B3%84\" aria-label=\"️ 스프링 빈과 의존 관계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>☘️ 스프링 빈과 의존 관계</h1>\n<p>이때까지 잘 만든 걸 화면이랑 붙여보자. 그러려면 Controller와 View Template이 필요하다.</p>\n<p>그럼 Controller가 Service를 통해 조회, 가입 등등을 한다. 그렇다면 MemberController가 MemberService를 의존하게 된다.</p>\n<p>이걸 스프링을 통해 스프링스럽게 해보자.</p>\n<h2 id=\"-컴포넌트-스캔과-자동-의존관계-설정\" style=\"position:relative;\"><a href=\"#-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%8A%A4%EC%BA%94%EA%B3%BC-%EC%9E%90%EB%8F%99-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84-%EC%84%A4%EC%A0%95\" aria-label=\" 컴포넌트 스캔과 자동 의존관계 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 컴포넌트 스캔과 자동 의존관계 설정</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">@Controller</code> 어노테이션을 통해 스프링이 시작될 때 스프링 컨테이너 통에 이 MemberController객체가 생성되어서 넣어진다.</p>\n<ul>\n<li><u><strong>Spring Bean</strong></u>이 관리된다.</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">MemberService</code> 역시 하나 생성해놓고 여러 컨트롤러에서 공유해서 사용해도 된다. 따라서 스프링 컨테이너에 등록해두는 것이 더 좋다. (+ 부가적인 효과.. coming soon..)</p>\n</li>\n<li>\n<p>생성자에 <code class=\"language-text\">@Autowired</code>를 적어준다면 해당 빈이 생성될 때 스프링이 컨테이너에 있는 필요한 인자들을 연결시켜준다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberService</span> memberService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberController</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberService</span> memberService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberService <span class=\"token operator\">=</span> memberService<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>어라랏 근데… <code class=\"language-text\">MemberService</code>를 스프링 컨테이너에 등록은 하셨나요? 등록하지 않으면 당연히 컨테이너에 없기 때문에 MemberController를 띄울 때 생성자에 자동으로 주입해주지 못할 것이다.</li>\n<li>그러니까 <code class=\"language-text\">MemberService</code>에는 <code class=\"language-text\">@Service</code>,  <code class=\"language-text\">MemoryMemberRepository</code>에는 <code class=\"language-text\">@Repository</code> 어노테이션을 붙여서 스프링에 등록하자.</li>\n</ul>\n<h3 id=\"스프링-빈을-등록하는-방법\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EC%9D%84-%EB%93%B1%EB%A1%9D%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"스프링 빈을 등록하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스프링 빈을 등록하는 방법</h3>\n<p>위 예시처럼 <code class=\"language-text\">@Controller</code>, <code class=\"language-text\">@Service</code>, <code class=\"language-text\">@Repository</code>를 하는 방법은 <u><strong>컴포넌트 스캔</strong></u> 방식이다.</p>\n<ul>\n<li>사실 위 어노테이션들은 <code class=\"language-text\">@Component</code> 어노테이션을 포함하고 있다. 이 어노테이션이 있으면, 스프링이 실행될 때 객체를 생성해서 컨테이너에 등록을 해둔다. 그리고 <code class=\"language-text\">@Autowired</code>가 서로 의존 관계를 이어준다.</li>\n</ul>\n<p>웬만하면 빈으로 등록하고 쓰게 되는데.. 이게 왜 좋은 지는 <mark>🔜</mark></p>\n<p>그리고 다른 방식은 아래에서 설명할 자바 코드로 직접 등록하는 방법이다</p>\n<p><u><strong>두 가지 방식 모두 알아야 한다.</strong></u></p>\n<h3 id=\"컴포넌트-스캔-위치\" style=\"position:relative;\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%8A%A4%EC%BA%94-%EC%9C%84%EC%B9%98\" aria-label=\"컴포넌트 스캔 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포넌트 스캔 위치</h3>\n<p>기본적으로 <code class=\"language-text\">@SpringBootApplication</code> 어노테이션이 있는 Application 클래스가 포함된 <u><strong>그 패키지 포함 하위 패키지를 스캔해서 등록</strong></u>해준다.</p>\n<ul>\n<li>사실은 위 어노테이션에 <code class=\"language-text\">@ComponentScan</code>이 포함돼있다. 이 어노테이션이 있으면 찾아서 들어오는 것</li>\n</ul>\n<h3 id=\"컴포넌트는-싱글톤\" style=\"position:relative;\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%8A%94-%EC%8B%B1%EA%B8%80%ED%86%A4\" aria-label=\"컴포넌트는 싱글톤 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포넌트는 싱글톤</h3>\n<p>스프링은 스프링 컨테이너에 스프링 빈을 등록할 때, 기본으로 싱글톤으로 등록한다(유일하게 하나만 등록해서 공유한다) 따라서 같은 스프링 빈이면 모두 같은 인스턴스다. 설정으로 싱글톤이 아니게 설정할 수 있지만, 특별한 경우를 제외하면 대부분 싱글톤을 사용한다.</p>\n<h2 id=\"-자바-코드로-직접-스프링-빈-등록하기\" style=\"position:relative;\"><a href=\"#-%EC%9E%90%EB%B0%94-%EC%BD%94%EB%93%9C%EB%A1%9C-%EC%A7%81%EC%A0%91-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0\" aria-label=\" 자바 코드로 직접 스프링 빈 등록하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 자바 코드로 직접 스프링 빈 등록하기</h2>\n<p>위 컴포넌트 스캔처럼 어노테이션을 통해 자동으로 등록하고 자동으로 연결했지만, 이번에는 <u><strong>직접 스프링에 등록</strong></u>해보자.</p>\n<h3 id=\"configuration-클래스-만들기\" style=\"position:relative;\"><a href=\"#configuration-%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"configuration 클래스 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuration 클래스 만들기</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberService</span> <span class=\"token function\">memberService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemberService</span><span class=\"token punctuation\">(</span><span class=\"token function\">memoryMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token function\">memoryMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemoryMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>\n<p>스프링이 <code class=\"language-text\">@Configuration</code>을 읽고, <code class=\"language-text\">@Bean</code>을 컨테이너에 올려준다.</p>\n</li>\n<li>\n<p>다만 <code class=\"language-text\">@Controller</code>는 스프링이 관리해야 하기 때문에 컴포넌트 스캔으로 두자.</p>\n</li>\n</ul>\n<h2 id=\"-참고\" style=\"position:relative;\"><a href=\"#-%EC%B0%B8%EA%B3%A0\" aria-label=\" 참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 참고</h2>\n<blockquote>\n<h3 id=\"di\" style=\"position:relative;\"><a href=\"#di\" aria-label=\"di permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DI</h3>\n<p>DI에는 필드 주입, setter 주입, 생성자 주입 이렇게 3가지 방법이 있다. 의존관계가 실행중에 동적으로 변하는 경우는 거의 없으므로 <u><strong>생성자 주입을 권장</strong></u></p>\n<ul>\n<li>필드 주입: 뭔가 다른 추가적인 일을 할 수 없다.</li>\n<li>setter 주입: setter가 public으로 열려 있게 된다. 문제 생길 여지가 있다.</li>\n<li>생성자 주입: 맨  처음 어플리케이션이 조립될 때만 호출되고 끝난다.</li>\n</ul>\n<p>주의할 점은 스프링이 생성해줄 때가 아니라 내가 직접 <code class=\"language-text\">new</code>할 때는 자동으로 연결되지 않는다. <u>스프링 컨테이너에 올라가는 것들만 정상적으로 연결</u>된다.</p>\n<h3 id=\"컴포넌트-스캔-vs-스프링-빈으로-직접-등록\" style=\"position:relative;\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%8A%A4%EC%BA%94-vs-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EC%9C%BC%EB%A1%9C-%EC%A7%81%EC%A0%91-%EB%93%B1%EB%A1%9D\" aria-label=\"컴포넌트 스캔 vs 스프링 빈으로 직접 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포넌트 스캔 vs. 스프링 빈으로 직접 등록</h3>\n<p>실무에서는 주로 정형화된 <u>컨트롤러, 서비스, 리포지토리</u> 같은 코드는 <code class=\"language-text\">컴포넌트 스캔</code>을 사용한다. 그리고 정형화 되지 않거나, <u><strong>상황에 따라 구현 클래스를 변경</strong></u>해야 하면 설정을 통해 <code class=\"language-text\">스프링 빈으로 등록</code></p>\n<p>➡️ 따라서 <code class=\"language-text\">MemberRepository</code> 구현체를 기존 운영 코드를 손대지 않고 바꿔치기 위해서 스프링 빈으로 등록하는 방법을 사용하자.</p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EA%B3%BC-%EC%9D%98%EC%A1%B4-%EA%B4%80%EA%B3%84\">☘️ 스프링 빈과 의존 관계</a></p>\n<ul>\n<li>\n<p><a href=\"#-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%8A%A4%EC%BA%94%EA%B3%BC-%EC%9E%90%EB%8F%99-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84-%EC%84%A4%EC%A0%95\">📌 컴포넌트 스캔과 자동 의존관계 설정</a></p>\n<ul>\n<li><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EC%9D%84-%EB%93%B1%EB%A1%9D%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">스프링 빈을 등록하는 방법</a></li>\n<li><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%8A%A4%EC%BA%94-%EC%9C%84%EC%B9%98\">컴포넌트 스캔 위치</a></li>\n<li><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%8A%94-%EC%8B%B1%EA%B8%80%ED%86%A4\">컴포넌트는 싱글톤</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%9E%90%EB%B0%94-%EC%BD%94%EB%93%9C%EB%A1%9C-%EC%A7%81%EC%A0%91-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0\">📌 자바 코드로 직접 스프링 빈 등록하기</a></p>\n<ul>\n<li><a href=\"#configuration-%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%A7%8C%EB%93%A4%EA%B8%B0\">Configuration 클래스 만들기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%B0%B8%EA%B3%A0\">📌 참고</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"October 04, 2022","title":"스프링 빈과 의존관계 - 스프링 입문 | 매일 1시간 👨🏻‍🏫 3일차","categories":"강의","author":"goldggyul","emoji":null,"imageEmoji":"spring-boot-logo.png"},"fields":{"slug":"/spring-hello-003/"}},"prev":{"id":"e5194c41-9cb6-5d3c-9557-152553bc59a8","html":"<blockquote>\n<p>본 게시글은 <a href=\"https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EC%9E%85%EB%AC%B8-%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/\">스프링 입문 - 코드로 배우는 스프링 부트, 웹 MVC, DB 접근 기술</a> 강의를 듣고 정리했습니다.</p>\n</blockquote>\n<h1 id=\"️-스프링-db-접근-기술\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%EC%8A%A4%ED%94%84%EB%A7%81-db-%EC%A0%91%EA%B7%BC-%EA%B8%B0%EC%88%A0\" aria-label=\"️ 스프링 db 접근 기술 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>☘️ 스프링 DB 접근 기술</h1>\n<p>JPA도 스프링만큼 오래된 기술이다. JPA를 더 편리하게 쓸 수 있도록 감싼 게 스프링 데이터 JPA이다.</p>\n<h2 id=\"-h2-데이터베이스\" style=\"position:relative;\"><a href=\"#-h2-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4\" aria-label=\" h2 데이터베이스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 H2 데이터베이스</h2>\n<p>보통 실무에서는 DB는 mysql, oracle을 활용한다.</p>\n<p>H2 데이터베이스는 가볍고 교육용으로 좋다.</p>\n<ul>\n<li>\n<p>접속</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/klEQVQY01WOsUrDQABAL+n1kuYud4Y2bU2ijQk0jUUUK62DINTBSXETXNwEKbgJfozgB4jf+ASLgsODNz2eOH35pL17w+QZWV1SFLsITyDEFs/z/vwXvyORgUH2EpRNCd2YJC/ZmzaI9vqJ5uqR45tnivaMpB8SG0cURQRB8C+ktcbEMdo4fGXo6hS1k9MvKsqjEw7aGeJw/cD08p7F7YZyvmSYaYYTS13XNE1DkiQMBgOUUlhrSYcjXJLiq5jAjgnTfSaLc2bLFZOqQqw2H6ye37l4/SKdrwmswGQC05dEuodz7icqpdyeeh18GSJDh7Ij4rwiLkpkpOn2Ir4BDchnlOeKj3AAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004164514925\" title=\"image-20221004164514925\" src=\"/static/f170326e1ce908ba3e67346a8d57b860/37523/image-20221004164514925.png\" srcset=\"/static/f170326e1ce908ba3e67346a8d57b860/e9ff0/image-20221004164514925.png 180w,\n/static/f170326e1ce908ba3e67346a8d57b860/f21e7/image-20221004164514925.png 360w,\n/static/f170326e1ce908ba3e67346a8d57b860/37523/image-20221004164514925.png 720w,\n/static/f170326e1ce908ba3e67346a8d57b860/b97f6/image-20221004164514925.png 958w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 90.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAADMklEQVQ4y42UaW/bRhCG9dv7KYhr9Fu+9we0iesLsIukdhrYsWQdFCleInWZpLgUuavL8iHnKbjyBaNAS+DB7M7uvjszO2Dlxv6dO/cjK/sjRe1XhtYZDTemZYfUDJ9vNYuzusNF0+W83qHacmlaIQ0z4NLwuDR8GlZAwwqptVwqa9nnYTpkrQbc5gHzyRV5IZFKURQ5UkoKKVFK6nGe5+R5oSmKzdoT5XpldXNL13PIxBh4gB93sF7y427JQsF6BdyDmsBqzn9+lXiyYOdrl4PzIYfVmMNqwsEju+eCg6rgsCb440yw/11w3Mg4qmccNV4ofeU+P5pRcaMZH46v+PBnzNbekPe7fbZ2B2wfjNjeH/Dz3oDt/SG/HI7Y2uvz7lPIu51wYz8Fmvc7IT/9FnJiCio3K4XXOcW1ThkE5yyki4hMQq/OMDQYBC099u0qIva4WY65nsXcLFLuVxPN7XWGzHwW05jKciGpXRxzcX5E16+RZx690MQ0mzhOG9s2sKwmzWaV4SBASkFRCJKkh+vU6PoNBn2TJLKRxaOg736nF9RJIouJcBn0TCyzge+ZeG4bxzFoGzXiqIdSgqnKiCOfVuMLVvsrgV9lktooGVO5XkqSaHNDNDKJI4s0sRFjR9uS8qJx3CEatbkaGoyGLeIrkzRxNOPY0fNnQds6od36TO3iiH54yWho4zgmjm3Q73ks5gWzWc58VjCfPzLLte/Jr+SYIo+eBG2cThfftclSW9fEcy16oatRUiBl+gbxjJIZ+SR6ETQNk3bLIuy65MKh3zP1YwSBjeeaum5KviVFyURHplRKkV89CSo65gmm8YU0McmzMqo2QkSUa2W6SmWvEMymOSLtk0QGaWJpxnH7pYatxl8YzVNd+DLlcdLVraEFZKZf9VmwnE9zMjEgTcr9rkaMOy+CYbdKL7jUL1oKponPpPxJTK6YZCNtyx7bEOlUMxE+CjqaZ8HlUpKlHYqJhxjburE954x67ZhW4zNn3/axrb83kcemLktJKVD6yjMbQespQqVTFWXYz+G7ug9Lmz7aLPXe4L46swlmqhIqDw8P3N/f/gt3r7j9X6zX9/wDNpAgzO2Fj9oAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004164927482\" title=\"image-20221004164927482\" src=\"/static/24f9340e426dbc5f327ca1a50c98210e/37523/image-20221004164927482.png\" srcset=\"/static/24f9340e426dbc5f327ca1a50c98210e/e9ff0/image-20221004164927482.png 180w,\n/static/24f9340e426dbc5f327ca1a50c98210e/f21e7/image-20221004164927482.png 360w,\n/static/24f9340e426dbc5f327ca1a50c98210e/37523/image-20221004164927482.png 720w,\n/static/24f9340e426dbc5f327ca1a50c98210e/8b69f/image-20221004164927482.png 912w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</li>\n<li>\n<p>처음 이용할 때는 데이터베이스 파일을 만들어야 한다. <code class=\"language-text\">JDBC URL</code>에 파일 경로를 입력하자.</p>\n</li>\n<li>\n<p>JDBC URL에 경로 입력 후에 만약 test라는 이름으로 생성했다면 test.mv.db가 있는 지 확인하자.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAgklEQVQI1x2MXQqDMBjACrNzfv50OlttoRU3O3CPu8Luf6YM+hQIJGr//mjvI41cudUNwyikPZBzxhhDjBGtNSEEUkrFWWtZ1xUzDAR9wfY9blmY5xnlnOMxTYi0KKXoup6c33jvS3yeJyJSeBxHmQXveb5ebM7xaWr2FEnbRlVV/AGEWDIJJCLemgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004165337031\" title=\"image-20221004165337031\" src=\"/static/c931a9fe1ea672d079ffbe33ffa8a230/37523/image-20221004165337031.png\" srcset=\"/static/c931a9fe1ea672d079ffbe33ffa8a230/e9ff0/image-20221004165337031.png 180w,\n/static/c931a9fe1ea672d079ffbe33ffa8a230/f21e7/image-20221004165337031.png 360w,\n/static/c931a9fe1ea672d079ffbe33ffa8a230/37523/image-20221004165337031.png 720w,\n/static/c931a9fe1ea672d079ffbe33ffa8a230/302a4/image-20221004165337031.png 1080w,\n/static/c931a9fe1ea672d079ffbe33ffa8a230/e6c84/image-20221004165337031.png 1148w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</li>\n<li>\n<p>이렇게 파일 생성 이후에는 위에처럼 파일을 직접 접근하는 것이 아닌 소켓을 통해 접근해서 여러 곳에서 파일을 접근해도 문제가 없도록 해야 한다.</p>\n<ul>\n<li>\n<p><code class=\"language-text\">jdbc:h2:tcp://localhost/~/test</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAcklEQVQI112ISxKCMBTAuP/lRDv9WF4BF1opUko5QJzpwoWLTDLp1FXQyvNJlvfLIoNiGh1jsMyTI4hpPGbf/p4jR0kcZfkjkXOkE+8Rf2ddLPFpMPpCEItzisFrjO7Rum/t7I1SVs66UevW/OszU/bEF+J3kguLZQIhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004165658153\"\n        title=\"image-20221004165658153\"\n        src=\"/static/78bbf92f899288bc931a6bc6e2e601b5/37523/image-20221004165658153.png\"\n        srcset=\"/static/78bbf92f899288bc931a6bc6e2e601b5/e9ff0/image-20221004165658153.png 180w,\n/static/78bbf92f899288bc931a6bc6e2e601b5/f21e7/image-20221004165658153.png 360w,\n/static/78bbf92f899288bc931a6bc6e2e601b5/37523/image-20221004165658153.png 720w,\n/static/78bbf92f899288bc931a6bc6e2e601b5/ae694/image-20221004165658153.png 850w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<h3 id=\"h2-연결-오류-카프카랑-같이-쓸-때-조심하세요\" style=\"position:relative;\"><a href=\"#h2-%EC%97%B0%EA%B2%B0-%EC%98%A4%EB%A5%98-%EC%B9%B4%ED%94%84%EC%B9%B4%EB%9E%91-%EA%B0%99%EC%9D%B4-%EC%93%B8-%EB%95%8C-%EC%A1%B0%EC%8B%AC%ED%95%98%EC%84%B8%EC%9A%94\" aria-label=\"h2 연결 오류 카프카랑 같이 쓸 때 조심하세요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>h2 연결 오류 (카프카랑 같이 쓸 때 조심하세요…)</h3>\n<p>근데 여기서 계속 오류가 났다.</p>\n<p><code class=\"language-text\">Connection is broken: \"java.io.EOFException: localhost\" [90067-210].</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAgUlEQVQI12WKsQ6DMBBD8/+/AgknQHxEl+6lUMohdYEbSiPB5OoSGiF1sOxn23ymCSqvzhzcH53yb/MnXnmMmRmraoz85hdMVxR4lCWGuobmZ9OgIwqd8t25uFdVyrcsQ0+ENs/RWhu8J4ervcBsy4I/zXPwXSTlJO1E4nZ89sSCL8pr16rqejJoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004173653726\"\n        title=\"image-20221004173653726\"\n        src=\"/static/4157a309331dfded47eb791f9ad03f01/37523/image-20221004173653726.png\"\n        srcset=\"/static/4157a309331dfded47eb791f9ad03f01/e9ff0/image-20221004173653726.png 180w,\n/static/4157a309331dfded47eb791f9ad03f01/f21e7/image-20221004173653726.png 360w,\n/static/4157a309331dfded47eb791f9ad03f01/37523/image-20221004173653726.png 720w,\n/static/4157a309331dfded47eb791f9ad03f01/5819f/image-20221004173653726.png 1042w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>도움말을 눌러서 보면</p>\n<blockquote>\n<ul>\n<li>\n<h4 id=\"connection_broken_1\" style=\"position:relative;\"><a href=\"#connection_broken_1\" aria-label=\"connection_broken_1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CONNECTION_BROKEN_1</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">public static final int CONNECTION_BROKEN_1</code></pre></div>\n<p>The error with code <code class=\"language-text\">90067</code> is thrown when the client could not connect to the database, or if the connection was lost. Possible reasons are: the database server is not running at the given port, the connection was closed due to a shutdown, or the server was stopped. Other possible causes are: the server is not an H2 server, or the network connection is broken.</p>\n<ul>\n<li>\n<p><strong>See Also:</strong></p>\n<p><a href=\"https://h2database.com/javadoc/constant-values.html#org.h2.api.ErrorCode.CONNECTION_BROKEN_1\">Constant Field Values</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p>무언가 소켓 연결에 문제가 생긴 걸 볼 수 있다.. 이거 때문에 설치하고 삭제하고 재부팅하고를 몇 번 반복했다.</p>\n<p>h2의 기본 포트는 <code class=\"language-text\">8082: 콘솔 브라우저 포트</code>, <code class=\"language-text\">9092: tcp 서버 포트</code>이다. 그래서 혹시 9092 포트가 겹쳐서 문제가 생기나 싶어서 해당 포트를 쓰는 프로세스를 확인해줬다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 맥 기준</span>\n<span class=\"token function\">lsof</span> <span class=\"token parameter variable\">-i</span> :9092\n<span class=\"token function\">kill</span> <span class=\"token parameter variable\">-9</span> <span class=\"token punctuation\">{</span>해당 PID<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 명령어로 9092 포트를 쓰는 프로세스를 kill하고 다시 실행해도 계속 되지 않았다..</p>\n<p>근데 <code class=\"language-text\">h2.sh</code>로 h2를 실행할 때 포트를 명시하는 방법이 있어서</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./h2/bin/h2.sh <span class=\"token parameter variable\">-tcpPort</span> <span class=\"token number\">9292</span></code></pre></div>\n<p>위 명령어로 9292에서 실행한 뒤에 <code class=\"language-text\">jdbc:h2:tcp://localhost:9292/~/test</code>로 포트번호를 명시한 뒤에 연결했더니 됐다!</p>\n<hr>\n<p>내 생각에 원인은 <u><strong>카프카(Kafka)가 설치되어 있던 것</strong></u> 때문이다.</p>\n<p><u><strong>카프카의 기본 포트는 9092다. h2의 기본 포트 역시 9092</strong></u>다.</p>\n<p>근데 나는 brew로 카프카가 설치되어 있던 경우라서, 예전에 <code class=\"language-text\">brew services start kafka</code>로 카프카가 실행되어 있던 게 계속 실행되고 있었고, 해당 프로세스를 수동으로 kill해도 brew가 계속 카프카를 실행해줬던 것으로 보인다.</p>\n<p>그리고 h2를 실행하고 tcp로 연결할 때 기본 포트 9092가 사용 중이여도 경고(already in use같은..)가 따로 뜨지 않고, 그냥 위에처럼 Connection is broken이 나온다.</p>\n<p>포트를 확인해보면</p>\n<ul>\n<li>\n<p>카프카가 9092 포트를 쓰고 있다가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/0lEQVQY0x2My26CQAAAuWmCRJEiAReWleWNBIWYVlutTZr0fWjafkH//xemqYfJZC5j7N5+CaSP7VgIEZJlGaZpMrEsbNtmMrEYjcaMTQvHCxBSc+WFJElDmzfs1zWnzYCWCiFXGJlWLBYeqU6Zz+e4rst0OsVxnEt7noeIJJFKUVlFUjTYrkBEmr5qeR5Kvs8Dj8db9ud7jKIomc1mlGWJlJIkSYjjmDAM8X2fvCjY9DvyumOpSsSqYmp7BEFMqhR3Xc3P04GvjweuDwNG3ayJlbqM/qmqCq31xUqt6LY9N4cjebNlEWaEusV2l0QipC0STn3J52vP+0tHmkn+AHbNcbaAkfKNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182114447\"\n        title=\"image-20221004182114447\"\n        src=\"/static/873e3d4a62e3b0d1dfd8bd6482bceb91/37523/image-20221004182114447.png\"\n        srcset=\"/static/873e3d4a62e3b0d1dfd8bd6482bceb91/e9ff0/image-20221004182114447.png 180w,\n/static/873e3d4a62e3b0d1dfd8bd6482bceb91/f21e7/image-20221004182114447.png 360w,\n/static/873e3d4a62e3b0d1dfd8bd6482bceb91/37523/image-20221004182114447.png 720w,\n/static/873e3d4a62e3b0d1dfd8bd6482bceb91/302a4/image-20221004182114447.png 1080w,\n/static/873e3d4a62e3b0d1dfd8bd6482bceb91/67a79/image-20221004182114447.png 1408w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>위에 PID 26162가 카프카 프로세스다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdklEQVQY0x2PyW7aQABAfapCGjUilEBsxOIZ2zMeL5hxsAG7CSlRWol0iTi1ET301P//gFeFH3iLc33TZTbzOb94R9+9RPiC8XjMYNTFlxN6Vz0cx+HsrEPn/D2di0s+dD8iRi7u0KXXH9O/ntAfThi4EicMA8IwZDAc4Ho3TGczpJTIQOB5Lp7n0R8MCZVm4gdEJieI59yWK5rSsrpt+dzsaJstRVHhKKVI0xQhJSqKMEIQSUkUKbIsI45j5guLyQt0WrCwNTa3pKakSuccHu94blva9Zqq/YSjtcYYg+/7SCHIRh5GypMgCAJEpImSnCQvMYslRVbSJAVLW/NQ1bw+rXndb3n59syPn99xtDG8QaO3uiQhyXN0HKO0JhSCcjpDSYWZV1TNjsyuqDf32MWSu1XF4csD/44vHH/t2W9rHCEk0+n0VJMkCdba06aKYxKl2fSuyP2ASZST2pZqs6Np75mnhse25nj4yt/jE39+P5IvUv4Db0K1VPMvOXcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182259208\"\n        title=\"image-20221004182259208\"\n        src=\"/static/3a3b84ec88eb75e991c9145a2e58c29e/37523/image-20221004182259208.png\"\n        srcset=\"/static/3a3b84ec88eb75e991c9145a2e58c29e/e9ff0/image-20221004182259208.png 180w,\n/static/3a3b84ec88eb75e991c9145a2e58c29e/f21e7/image-20221004182259208.png 360w,\n/static/3a3b84ec88eb75e991c9145a2e58c29e/37523/image-20221004182259208.png 720w,\n/static/3a3b84ec88eb75e991c9145a2e58c29e/302a4/image-20221004182259208.png 1080w,\n/static/3a3b84ec88eb75e991c9145a2e58c29e/52576/image-20221004182259208.png 1412w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n</li>\n<li>\n<p>h2에 tcp로 접속을 시도하면 9092 포트에 <u><strong>closed 소켓이 증가</strong></u>한 걸 볼 수 있다..</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVQY0zWOQW6DMBQFkVraSIkTwNjGxpiCSUhCRbNq7tBL9P6nmMpIXTz9zX/zJvv++cUFSa0rxjEyTRPH45GiKKjrGiEE+/2ePM+RSqGcR5xOSCkpywqlNLJWvOZv5O87sjh80DR2A5VliTFmu1VVbdFaY63FOcc4jvTnmUNRYq1D6wbnA/044fsB1Tiy9JRM7vc7XddtpZQE8N5zvV5Z15XQ99tYrTRCHFDaIApJpS1NN2C7SGU82TzPm0GMkcvlsoGTbcowDDweD57PJyEEnGsxpuEkBHNMRh7TjoThRjfc0G4kSwbJJNkl6L9dAi7LQhpclk/W9QtjHaU0vOwEMQRi6LE2EvyZtjvj2ok/SguESodxgj0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182317850\"\n        title=\"image-20221004182317850\"\n        src=\"/static/14f78b1d5baa7ce69b937c24f38f3181/37523/image-20221004182317850.png\"\n        srcset=\"/static/14f78b1d5baa7ce69b937c24f38f3181/e9ff0/image-20221004182317850.png 180w,\n/static/14f78b1d5baa7ce69b937c24f38f3181/f21e7/image-20221004182317850.png 360w,\n/static/14f78b1d5baa7ce69b937c24f38f3181/37523/image-20221004182317850.png 720w,\n/static/14f78b1d5baa7ce69b937c24f38f3181/302a4/image-20221004182317850.png 1080w,\n/static/14f78b1d5baa7ce69b937c24f38f3181/bb543/image-20221004182317850.png 1418w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>그리고 이 26730번 프로세스는 h2 프로세스다. 아마 h2가 9092로 연결하려다가 already in use라 소켓이 그냥 닫혀버린 것으로 추측할 수 있다. 이거 경고가 안 떠서 한참 삽질…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAsUlEQVQI1yWOTW6DMBgFWZYUJ8YEHJvPP9SGCKoue4ne/z4TlSyeNIvR6DXl9w+fA7UWJDqs76mlIiEwjiPOObTWXJXCD4bBPvjoFG3b0nUdl8/3tBno1I3G2gcxCEmEfd+JMSASmGdhWRaO4yDlTBBh845aV762J/O/IxHrBEmF8vxm8oHGDANbSvzMnpzzGfL+zeu6nkFjDL3WpGmiv97OA0tOmNGh+om7i7i4cveZF8iMTno69FwbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182405697\"\n        title=\"image-20221004182405697\"\n        src=\"/static/5095785554e27fa88937f6676c88c858/37523/image-20221004182405697.png\"\n        srcset=\"/static/5095785554e27fa88937f6676c88c858/e9ff0/image-20221004182405697.png 180w,\n/static/5095785554e27fa88937f6676c88c858/f21e7/image-20221004182405697.png 360w,\n/static/5095785554e27fa88937f6676c88c858/37523/image-20221004182405697.png 720w,\n/static/5095785554e27fa88937f6676c88c858/302a4/image-20221004182405697.png 1080w,\n/static/5095785554e27fa88937f6676c88c858/ccf0c/image-20221004182405697.png 1428w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>그냥 기본으로 <code class=\"language-text\">./h2.sh</code>말고 <code class=\"language-text\">./h2.sh -tcpPort 9092</code>로 실행하면 already in use가 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADJklEQVQ4yz2UWW/jRhCEqcgIbPjSaUqkxHuG1/DQZcmyY+8RLJLFBgmQl/z/P/IFPd7dhwJnhuya7upqOis/oH75m4XvEqklXjjH9ackSYLW2kLWq9WKxWJBEAQsFwtc12U2m9nz6Wxm97e3tzgSUBaaqqro+w1912NqQ10bjDE8PDywXC5ZuC4Provvr1h6niUXeL5nyTzPsxc4SRyjlEZpRZqmNqM8z4miyD7X6zVhGBLHMWmm0FVNGMU2a/lezu/u7rgfjRmNJzgSIC+EQAKzLPtJKpjP59zf3zOdThmPx7irgNlCspkzGo2ZzV3G0xnu0mfuLnGERAjS75oJoRDJzWVZ2gxlHUaRfafygsoYyrKirBsyXXIznnN1N7FwkjSlrmurU1EUP7MV8WUtUEpZyAVa53RNw/l4wLQbCrMhVjV5tcULNY6IKcLK7RIsQaJPbLVV9lz2knWmNE23xXRburokT1KiuCJNDSpvSVSHMxj8guM4XF9fM5lMLEQ3gXRYnpPpFH8dsApi/CDBD6WBFY9tS1t0tLol14a66nCGwwsGg4EllLbPvntKIDII4XQ6xw8T/Ci1ZF6QkWWGXdnwWxnyXCgKrchNI8kNGA6HlkD0+WGFtm3fTZ2mtszC9HT7M/3hzPH0xuPxhQ+nJ/79eOC/P154fnqk3hghdBheXFiT5kVhNRNC21GlKauaom5RZU93eGX/9Imu39NUDYe+5ct5x1+/97w9K/y1KyUPubq6suX9GDWBNKSqa3ReYvoddX+g3j6zOX3AbB6JxFaxx6kP+PASc9zH3E/HOGLa0WhkR+fdFtqOnFioNg1l3dLvzzS7J6rticfXT5w+f+Hz16+cz3tez1u+/fnGblcSJyucm5sbOzriPdHvfS595vMHFkufVZhZfwW6J2kOFPsT5fGE6RvyUqG0pig0Ok+I0+C95MvLS2tk67Uss1MQJylKl6iiwWxO5Jsz5vyR07d/6I4nNvs9pmsxXYeuG9yly/X93XtTxDYyq1KmaCfjKD+CMMpYR4q82ZM2e6qnV4rtAVVWNJsNWZ6T5CWlqfFWHr/e3PI/Mn7AYcabff0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182514284\"\n        title=\"image-20221004182514284\"\n        src=\"/static/5e2bd2c504766c23a482a0a7cbb5a63a/37523/image-20221004182514284.png\"\n        srcset=\"/static/5e2bd2c504766c23a482a0a7cbb5a63a/e9ff0/image-20221004182514284.png 180w,\n/static/5e2bd2c504766c23a482a0a7cbb5a63a/f21e7/image-20221004182514284.png 360w,\n/static/5e2bd2c504766c23a482a0a7cbb5a63a/37523/image-20221004182514284.png 720w,\n/static/5e2bd2c504766c23a482a0a7cbb5a63a/302a4/image-20221004182514284.png 1080w,\n/static/5e2bd2c504766c23a482a0a7cbb5a63a/2a08f/image-20221004182514284.png 1422w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n</li>\n<li>\n<p>그래서 kafka를 <code class=\"language-text\">brew services stop kafka</code> stop 시켜준 뒤에, 포트를 쓰고 있는 프로세스를 확인하면 다 닫혀있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQY0yXQzU6DQABFYRYmtUADNMx0ysxA+ZGBAloxIdqYGHVR3/+FjhFXZ/cl93pxuqFtHcYYpJQ0TcM4TZRVQ5QIZHZir0oCecIXhkAolOsRWiFlTJxEZDLBGoE2Eq9qcrquo65riqJgGAayTHMeJoSyjJeFY3mmmhbq+Q33/kHR9zTOYXJLGO2480Puw5AkjfHi/XYF8jxf0a3vE4Q7xCEj3h/wI0mQWkTV8/z9Q/96xZYl3Tiu6EPXUbmOzBhSmeIpdVxnOudo2xatDf155PHywmVecOPM9fPG8nWjfpo5aMsm3HG0FvV3k/5vUZ7W/gKVv2zaz2VYZgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004182847384\"\n        title=\"image-20221004182847384\"\n        src=\"/static/d066eece24d95721ee6bbf12e054785c/37523/image-20221004182847384.png\"\n        srcset=\"/static/d066eece24d95721ee6bbf12e054785c/e9ff0/image-20221004182847384.png 180w,\n/static/d066eece24d95721ee6bbf12e054785c/f21e7/image-20221004182847384.png 360w,\n/static/d066eece24d95721ee6bbf12e054785c/37523/image-20221004182847384.png 720w,\n/static/d066eece24d95721ee6bbf12e054785c/302a4/image-20221004182847384.png 1080w,\n/static/d066eece24d95721ee6bbf12e054785c/0c3d0/image-20221004182847384.png 1414w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>이 상태에서 연결을 다시 하면? 잘 된다!</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC6ElEQVQ4y4WSS2/bRhRG9Z+7qoN02VX+QPcFmqbZdBOgcNPUBhw3lmRJfFOiREp8czjkULac2G1ziiFtA0ZfBA5m7p3hfc036rqWKAy4/XjN5z/v+PzHLb/f3nB3+wnVwMcD3H0CKejt//tGu1xyPg8wgxJrLbA3AjOoMIKKia0wVi3WWjF1BpaJwt89ZRkr3G3Lrrxi9NaUvHhT8vWPGUff7zh6ueXZqx3Pf4j56vWW56/1XhPx7FXIl9/9naOXIV98G/LNccqoljnT+XtMe4wfLMiKgHXk4Sxt/MDF8e2ezXZNVqZkZfJIXmUDImObbMjLiJFqEuaTY4zZL0TBGCV9wmDObPoe177EsSbMpmdEG5dWpkgRI0WCFDvKbE2Zr6mKkCpfIcWaUS1iLic/YyxOyRKLWviEGwvPswkCj2Dl4bkWRZFyOOy5ulIcDlc0MmM6PmYxe4e5OKGuPKTYMOpUjhRLGrmmrpaUuUueOuSZQ5E55KlNEpuksdknfIrZk6cWabyg1hW2TYq5+BVjfsL88h27aE6W+Gwjj3DjkCYBnSpQbf4fFLRNRi22jPRcPGfM0rvEcy7IU5NtZON5Fr5nEm58uq5GtRVKiadoX+/Xa4motowaWWDMIxxrx8oPaKXPOjBwHc0C1zWYzy6wrRmGMSFNI/Z7Sadq9vvmka6TiGo3tDybvsUyThGliyg9otAiy7bIOkOIFFGl1GLY6wI6JahF0s+6zL0ePe9aP4pqU2zzlKX3G1Xh9q+lA1Zlwr4TfSudqh7RtuoDxpS53RegqQoHWeuATcr4w0+9bB4OGhlzc3PN9bXqpaLXfadba/v2tHQamVNk9v0/9wEfZKOrqiv/vkKf9WqCa5/jux+wzDOC1YSq8CkylyIf0PJ6qG4I6iLrcGi5yMw+Q5U7/Rw3wQW+e8bSO8cyTnq7Ll2qwh7u/QNlbg06PFw3NHJH2yS0TUwrY3SSTg3sVdbb2t+f/ws6htbrX1+BiaCnIKbUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004182925643\" title=\"image-20221004182925643\" src=\"/static/9463cf2bd1073775f51e598a91f6b4bc/37523/image-20221004182925643.png\" srcset=\"/static/9463cf2bd1073775f51e598a91f6b4bc/e9ff0/image-20221004182925643.png 180w,\n/static/9463cf2bd1073775f51e598a91f6b4bc/f21e7/image-20221004182925643.png 360w,\n/static/9463cf2bd1073775f51e598a91f6b4bc/37523/image-20221004182925643.png 720w,\n/static/9463cf2bd1073775f51e598a91f6b4bc/8b69f/image-20221004182925643.png 912w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</li>\n<li>\n<p>삽질한게 짜증나서 카프카를 삭제했다 ^^</p>\n</li>\n</ul>\n</blockquote>\n<h3 id=\"member-테이블-생성\" style=\"position:relative;\"><a href=\"#member-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%9D%EC%84%B1\" aria-label=\"member 테이블 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>member 테이블 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> member <span class=\"token keyword\">CASCADE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> member\n<span class=\"token punctuation\">(</span>\n id <span class=\"token keyword\">bigint</span> generated <span class=\"token keyword\">by</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">identity</span><span class=\"token punctuation\">,</span>\n name <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.55555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABqElEQVQoz42Q227aQBRF/f//kj4GCaqqLRgHE2KwsSHhYgPBQcZ3fK2AVdlBFarUwpa2zpnRnDV7Rsj8MeZyjmWtsCyL1WrFbDZjs9lgmiZl+YsP20QSG2ijDs/yV7qdR8aqiDrsIImPaCORZ7mFPu4jePt35kuTZrPJl4cHNE3jcDjUDoKA0+nEdrvhSWoznWio6oCu+AO5J9L++Q3lRcb3HDz3gzBwEapmbw9RhiMURWEymdQp1+s10+kU27bJsowwjOq0x+OJPC9I04woiimKkmsJe9dlsnbQdZ0oivhb5/OZsiz5n6oz5/OprsLKdlENE8MwWCwWeJ5X2/d98jyvB4qi4Hg8Xg3/28LWS2pAHMfsdrv6iY7j1E6S5A+w+su7gNyhsvxMeAtWA68XVYrK13ufwJJLe1PCrRsr5XlCmgTkWUSWBmRpWDu/1GvfBcySPX2pgap859Xo8tJvMZBbyN0GPbHB7l0j9ueE7tt9wCrdoD+gJ+mInRm7rU7gzvCcV3znjUOwJIksktC8N6FL/6mJ1GkyHLSZjkVif0EaW6QXUAWt/Btu0Y/zP+YItQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004184650720\" title=\"image-20221004184650720\" src=\"/static/982c00971f58c195a0c84f5768553d7c/37523/image-20221004184650720.png\" srcset=\"/static/982c00971f58c195a0c84f5768553d7c/e9ff0/image-20221004184650720.png 180w,\n/static/982c00971f58c195a0c84f5768553d7c/f21e7/image-20221004184650720.png 360w,\n/static/982c00971f58c195a0c84f5768553d7c/37523/image-20221004184650720.png 720w,\n/static/982c00971f58c195a0c84f5768553d7c/27b8e/image-20221004184650720.png 836w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<ul>\n<li>h2 콘솔 말고도 인텔리제이에서 database에 추가해서 작업할 수도 있다.</li>\n</ul>\n<p>이 때 sql 쿼리들 역시 편리하게 관리하기 위해서 루트 디렉터리 아래에 <code class=\"language-text\">sql</code> 디렉터리를 만들고 <code class=\"language-text\">ddl.sql</code>로 만들어서 관리해주자. <u><strong>git을 사용하니까 sql 역시 이렇게 프로젝트 내에 포함해서 관리하는 게 더 좋은 것 같다!</strong></u></p>\n<h2 id=\"-순수-jdbc\" style=\"position:relative;\"><a href=\"#-%EC%88%9C%EC%88%98-jdbc\" aria-label=\" 순수 jdbc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 순수 JDBC</h2>\n<p>20년도 더 전에 하던 방법이지만 간단하게 알아보자!</p>\n<h3 id=\"buildgradle\" style=\"position:relative;\"><a href=\"#buildgradle\" aria-label=\"buildgradle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>build.gradle</h3>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\">implementation <span class=\"token string\">'org.springframework.boot:spring-boot-starter-jdbc'</span>\nruntimeOnly <span class=\"token string\">'com.h2database:h2'</span></code></pre></div>\n<ul>\n<li>자바는 db와 연결하기 위해 jdbc 드라이버가 필요하다.</li>\n<li>db와 붙을 때 데이터베이스가 제공하는 클라이언트로 h2database</li>\n</ul>\n<h3 id=\"db-정보-설정하기\" style=\"position:relative;\"><a href=\"#db-%EC%A0%95%EB%B3%B4-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"db 정보 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>db 정보 설정하기</h3>\n<p>application.properties에 설정해주자</p>\n<div class=\"gatsby-highlight\" data-language=\"properties\"><pre class=\"language-properties\"><code class=\"language-properties\"><span class=\"token key attr-name\">spring.datasource.url</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">jdbc:h2:tcp://localhost/~/test</span>\n<span class=\"token key attr-name\">spring.datasource.driver-class-name</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">org.h2.Driver</span>\n<span class=\"token key attr-name\">spring.datasource.username</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">sa</span></code></pre></div>\n<h3 id=\"jdbcmemberrepository\" style=\"position:relative;\"><a href=\"#jdbcmemberrepository\" aria-label=\"jdbcmemberrepository permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JdbcMemberRepository</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JdbcMemberRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JdbcMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataSource <span class=\"token operator\">=</span> dataSource<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into member(name) values(?)\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> pstmt <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ResultSet</span> rs <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            conn <span class=\"token operator\">=</span> <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// sql 실행 후에 insert된 멤버의 id를 얻어오기 위해 generated_keys 옵션을 넣어준다.</span>\n            pstmt <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span>\n                    <span class=\"token class-name\">Statement</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RETURN_GENERATED_KEYS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> member<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            rs <span class=\"token operator\">=</span> pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">getGeneratedKeys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 얻어온 id 값으로 member의 id 세팅해준다.</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id 조회 실패\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// close를 안해주면 connection이 계속 쌓여서 장애가 날 수도 있다.</span>\n            <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">,</span> pstmt<span class=\"token punctuation\">,</span> rs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from member where id = ?\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> pstmt <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ResultSet</span> rs <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            conn <span class=\"token operator\">=</span> <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">setLong</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            rs <span class=\"token operator\">=</span> pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">,</span> pstmt<span class=\"token punctuation\">,</span> rs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from member\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> pstmt <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ResultSet</span> rs <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            conn <span class=\"token operator\">=</span> <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            rs <span class=\"token operator\">=</span> pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> members <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                members<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> members<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">,</span> pstmt<span class=\"token punctuation\">,</span> rs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from member where name = ?\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> pstmt <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ResultSet</span> rs <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            conn <span class=\"token operator\">=</span> <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            rs <span class=\"token operator\">=</span> pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">,</span> pstmt<span class=\"token punctuation\">,</span> rs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// DataSourceUtils를 통해 connection을 받아야 트랜잭션 같은 게 걸리면 connection을 유지해준다.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Connection</span> <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">DataSourceUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 순서대로 해제해줘야 해서 복잡하다.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Connection</span> conn<span class=\"token punctuation\">,</span> <span class=\"token class-name\">PreparedStatement</span> pstmt<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ResultSet</span> rs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rs <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                rs<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pstmt <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                pstmt<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>conn <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Connection</span> conn<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SQLException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">DataSourceUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">releaseConnection</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">,</span> dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>db에 붙으려면 데이터 소스가 필요하다. 그리고 스프링에게 주입받아야 한다. (properties에 세팅한 대로 주입받을 수 있다)</li>\n<li>데이터 소스로부터 getConnection을 하면, 진짜 db와 연결된 그 소켓을 받을 수 있다. 그 커넥션에 쿼리를 날리면 된다.</li>\n<li>insert는 update 조회일 땐 execute…</li>\n</ul>\n<p>그리고 SpringConfig에 등록해놨던 <code class=\"language-text\">MemberRepository</code> 빈 구현체를 위에서 만든 <code class=\"language-text\">JdbcMemberRepository</code>로 바꿔주자.</p>\n<ul>\n<li><u><strong>이렇게 설정만 바꾸면 다른 부분 건드리지 않고도 간단하게 구현체를 바꿀 수 있다!</strong></u></li>\n<li>객체지향적인 설계 -> <mark>다형성</mark> 활용\n<ul>\n<li>이게 굉장히 편리하게 되도록 스프링이 지원해준다.</li>\n<li>보통은 각 코드에서 직접 다 고쳐야 하지만, 설정 코드만 바꿔도 된다!</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringConfig</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token function\">memoryMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// return new MemoryMemberRepository();</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JdbcMemberRepository</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 스프링을 껐다 켜도 h2 db에 저장되기 때문에 날아가지 않는다!</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAADWUlEQVQ4y52RWW8bVRTH/XmQkHjhI/BhEE+IB155QUVqo5I2YQstCqKUSoSQNCsmbu3E69jjbRZnxmN7vMbrzMS74/iH7JK0lPYhPdLRObrn3t/93/91ObF1eslfmKpPGEqPOU9vkD78gdTBd4g7qwhby4Q27y5qdPse4s594otcQX/2I+bJTxR8Dymc/Ewh+ATXsJamWxTpV5Kc5wM0T+5h7H+FsXcLbedL9P3b6AdLZA+X0A+X0PbvoB0soR3cIee+S+Hoa0zPMqb7NsW/buGy7HOEaIywqNDUvEy//wDWPyS38T4X2x/hRNawog9o+1eYyeuQfQz6I9B/Be0RaPPX/QaeTxg+eA9Xv9dDltKUKmeo4T0m7k+ZeT9n4PuM4fEXtKUdSsIGZ7Hfaaf+xJGfYsvbOPI2lrT1osp7WMEVGlsf47IsC1mSUDKnJIVjLOUp45ybad5DV95koPxBxvMQ2b1GfPcbQpvLRLbuE9/7FnFnhfjuKsm9VVIHa0judVzT6ZTxeEzHsogEfdRlL00zTKvgI6FIyKljspKHkuanYoSp5qIYig9dek45GyGrhGgUZQo5P5r+DBf/xlypEAnSLCrUaxqtmkJYq5KQk+haDLMgU6vlqFYNJCmAIgcxsgmSyQjVSh7FiBCRPLhmsxkwo9OxiIth2mdpFFVD03UKximVcpFKpbLIwWCI1alz7N0lIfoIBQ7xerYQY88JnhwS8O1fAV8ojEQEmvUSpaJOKBTGHwhQr9dxHGdRO50Otm2hqgpnZzXK5RKGkSWTyZBOp+hY7VeBHQQhRr1uUihqqOopjUaDdrtNq9Va9M1mc+H33Pe3xTVw/imxqEC+3CCuFsmoCsPhiPn88vLy+sBkMuHi4mLRz2ev538UhoUo2XKTWrWKaZrk83lKpdIi5+puBJz7I4oi0+lLNa9vfifg1fOu1mf8H/jqpW/38A3ANykcj0cM+ueMxwNGwx7jUZ/x6GW9MXAy7pESj0jFPeT1MKLwN4noEeHAPumE9x0UDruokkLQrxIO6rTqGZx2FrulY7ezNwcOBzaO3cI0i1iWTc8p07Nz9JwCPTt/c+Bo6FApG8hyipyh0bVLdC2DrpWja+duDryY9MnIfk6VEKrkp9PU6DuFa+A/MB+1iqYEvZYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"image-20221004200150128\" title=\"image-20221004200150128\" src=\"/static/d2693745a55c2a2a8bf144c1832f3c6d/37523/image-20221004200150128.png\" srcset=\"/static/d2693745a55c2a2a8bf144c1832f3c6d/e9ff0/image-20221004200150128.png 180w,\n/static/d2693745a55c2a2a8bf144c1832f3c6d/f21e7/image-20221004200150128.png 360w,\n/static/d2693745a55c2a2a8bf144c1832f3c6d/37523/image-20221004200150128.png 720w,\n/static/d2693745a55c2a2a8bf144c1832f3c6d/d9217/image-20221004200150128.png 904w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<h3 id=\"ocp\" style=\"position:relative;\"><a href=\"#ocp\" aria-label=\"ocp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OCP</h3>\n<ul>\n<li>\n<p><u>개방 폐쇄 원칙</u> <code class=\"language-text\">Open-Closed Principle</code></p>\n<ul>\n<li>확장에는 열려있고, 수정에는 닫혀있다.</li>\n</ul>\n</li>\n<li>\n<p><u><strong>인터페이스 등으로 객체 지향에서 말하는 다형성을 잘 활용하면 기능을 완전 변경해도 애플리케이션 전체를 수정할 필요가 없다!</strong></u> (조립하는 코드만 바꾸면)</p>\n</li>\n<li>\n<p>스프링 <u>Dependencies Injection</u>을 통해 기존 코드 변경 없이 구현 클래스를 변경할 수 있었다.</p>\n</li>\n<li>\n<p>이 경우 개방 폐쇄 원칙이 지켜졌다!</p>\n</li>\n<li>\n<p>객체 지향의 진짜 매력 ✨</p>\n</li>\n</ul>\n<h2 id=\"-스프링-통합-테스트\" style=\"position:relative;\"><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\" 스프링 통합 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 스프링 통합 테스트</h2>\n<p>그럼 이제 db 연결을 했으니 테스트도 스프링과 db를 다 올려서 해봐야겠죠?</p>\n<ul>\n<li>\n<p>스프링 테스트할 때는 <code class=\"language-text\">@SpringBootTest</code>를 Test에 붙여주면 된다. 그리고 <code class=\"language-text\">@Tracsactional</code>도 붙여주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@SpringBootTest</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberServiceIntegrationTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">@BeforeEach</code>로 객체 생성하던 것에서, 이제 스프링으로부터 주입을 받아야 한다. 테스트니깐 굳이 생성자 주입 필요 없이 그냥 필드 주입으로 해도 괜찮다.</p>\n<ul>\n<li>어차피 다른 곳에서 또 쓰일 일이 없고 테스트 하면 끝이기 때문이다.</li>\n<li>또한 구현체를 스프링으로부터 받을 것이므로 <code class=\"language-text\">MemoryMemberRepository</code>대신에 <code class=\"language-text\">MemberRepository</code>로 선언해도 괜찮다.</li>\n<li><code class=\"language-text\">@AfterEach</code>로 매번 지워주던 것이 <code class=\"language-text\">@Transactional</code> 덕분에 필요가 없다.\n<ul>\n<li>테스트할 때는 보통 테스트 전용 db를 따로 구축한다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"code-classlanguage-textspringboottestcode\" style=\"position:relative;\"><a href=\"#code-classlanguage-textspringboottestcode\" aria-label=\"code classlanguage textspringboottestcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">@SpringBootTest</code></h3>\n<ul>\n<li>스프링 컨테이너와 테스트 함께 실행한다</li>\n</ul>\n<h3 id=\"code-classlanguage-texttransactionalcode\" style=\"position:relative;\"><a href=\"#code-classlanguage-texttransactionalcode\" aria-label=\"code classlanguage texttransactionalcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">@Transactional</code></h3>\n<ul>\n<li>테스트 케이스에 이 애노테이션이 있으면, 테스트 시작 전에 트랜잭션을 시작하고, 테스트 완료 후에 항상 롤백한다. 이렇게 하면 DB에 데이터가 남지 않으므로 다음 테스트에 영향을 주지 않는다.</li>\n</ul>\n<blockquote>\n<p>물론 test말고 service 등등 다른 곳에서는 롤백하지 않는다.</p>\n<p><code class=\"language-text\">@Commit</code> 같이 커밋해준다거나 하는 다른 옵션도 있다.</p>\n</blockquote>\n<h3 id=\"code-classlanguage-textunit-testcode-vs-code-classlanguage-textintegration-testcode\" style=\"position:relative;\"><a href=\"#code-classlanguage-textunit-testcode-vs-code-classlanguage-textintegration-testcode\" aria-label=\"code classlanguage textunit testcode vs code classlanguage textintegration testcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">Unit Test</code> Vs. <code class=\"language-text\">Integration Test</code></h3>\n<p>그 전에 스프링 없이 했던 테스트는 순수하게 자바 코드로, 최소한의 단위로 테스트했다. 이걸 <u><strong>단위 테스트</strong></u>라고 한다.</p>\n<p>그리고 스프링 컨테이너, db 등을 연동해서 테스트하는 것을 <u><strong>통합 테스트</strong></u>라고 한다.</p>\n<p>가급적이면 순수한 <u><strong>단위 테스트가 더 좋은 테스트일 확률이 높다</strong></u>. 따라서 <u><strong>단위 대로 쪼개서 테스트를 잘 하고, 스프링 없이도 테스트할 수 있도록 훈련</strong></u>하는 편이 좋다. 컨테이너를 꼭 올려야 한다면 테스트 설계가 잘못됐을 확률이 있다.</p>\n<h2 id=\"-스프링-jdbctemplate\" style=\"position:relative;\"><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-jdbctemplate\" aria-label=\" 스프링 jdbctemplate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 스프링 JdbcTemplate</h2>\n<p>스프링 jdbcTemplate 라이브러리 MyBatis와 비슷한 라이브러리다. 이 라이브러리는 JDBC API에서 반복 코드를 제거해준다. 하지만 역시 SQL은 직접 작성해야 한다.</p>\n<blockquote>\n<p>디자인 패턴 중 템플릿 메소드 패턴을 이용해서 코드를 많이 줄여서 JdbcTemplate이라고 한다.</p>\n</blockquote>\n<p>요건 실무에서도 많이 쓴다.</p>\n<ul>\n<li>\n<p><code class=\"language-text\">JdbcTemplateMemberRepository</code></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JdbcTemplateMemberRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JdbcTemplate</span> jdbcTemplate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JdbcTemplateMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jdbcTemplate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JdbcTemplate</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>jdbcTemplate을 주입받는 것은 아니고, DataSource를 주입받아서 jdbcTemplate을 생성해준다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JdbcTemplateMemberRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JdbcTemplate</span> jdbcTemplate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JdbcTemplateMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jdbcTemplate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JdbcTemplate</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 쿼리를 짤 필요가 없다.</span>\n        <span class=\"token class-name\">SimpleJdbcInsert</span> jdbcInsert <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleJdbcInsert</span><span class=\"token punctuation\">(</span>jdbcTemplate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        jdbcInsert<span class=\"token punctuation\">.</span><span class=\"token function\">withTableName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"member\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">usingGeneratedKeyColumns</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> parameters <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        parameters<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> member<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Number</span> key <span class=\"token operator\">=</span> jdbcInsert<span class=\"token punctuation\">.</span><span class=\"token function\">executeAndReturnKey</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MapSqlParameterSource</span><span class=\"token punctuation\">(</span>parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">longValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> jdbcTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select * from member where id = ?\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function\">memberRowMapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> jdbcTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select * from member\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function\">memberRowMapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> jdbcTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select * from member where name = ?\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">,</span> rowNum<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 결과 mapping</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">RowMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">memberRowMapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// return new RowMapper&lt;Member>() {</span>\n        <span class=\"token comment\">//     @Override</span>\n        <span class=\"token comment\">//     public Member mapRow(ResultSet rs, int rowNum) throws SQLException {</span>\n        <span class=\"token comment\">//         Member member = new Member();</span>\n        <span class=\"token comment\">//         member.setId(rs.getLong(\"id\"));</span>\n        <span class=\"token comment\">//         member.setName(rs.getString(\"name\"));</span>\n        <span class=\"token comment\">//         return member;</span>\n        <span class=\"token comment\">//     }</span>\n        <span class=\"token comment\">// };</span>\n\n        <span class=\"token comment\">// 위에랑 같은데 람다로</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">,</span> rowNum<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            member<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            member<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<p><u><strong>테스트를 잘 작성하는 것에 대해서 항상 고민해야 한다.</strong></u> 실제로 60~70퍼센트는 테스트 코드를 작성한다.</p>\n<h2 id=\"-jpa-java-persistence-api\" style=\"position:relative;\"><a href=\"#-jpa-java-persistence-api\" aria-label=\" jpa java persistence api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 JPA: Java Persistence API</h2>\n<p>JdbcTemplate을 사용하니, 반복적인 코드가 확 줄었다. 하지만 <u><strong>결국 sql을 개발자가 직접 작성해야한다.</strong></u></p>\n<p>JPA라는 기술을 사용하면 쿼리도 자동으로 생성해준다!</p>\n<ul>\n<li>그 전에 메모리 db를 사용했던 것처럼 그냥  JPA에 집어넣으면 처리해준다.</li>\n</ul>\n<p>JPA를 사용하면, <u>SQL과 데이터 중심의 설계</u>에서 <u><strong>객체 중심의 설계</strong></u>로 패러다임을 전환을 할 수 있다. 개발 생산성을 크게 높일 수 있다.</p>\n<p>JPA도 스프링만큼 넓고 깊이가 있는 기술이다. 스프링만큼 깊게 공부해야 한다.</p>\n<p>스프링에서도 JPA를 굉장히 많이 지원한다.</p>\n<h3 id=\"interface\" style=\"position:relative;\"><a href=\"#interface\" aria-label=\"interface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interface</h3>\n<p>JPA는 인터페이스고, 구현체로  hibernate 등등이 있다. 거의 hibernate 사용한다. 기본적으로 JPA는 오픈소스 hibernate 구현체가 사용된다.</p>\n<h3 id=\"orm\" style=\"position:relative;\"><a href=\"#orm\" aria-label=\"orm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ORM</h3>\n<p>JPA는 ORM 기술이다. 객체(Object)와 관계형(Relational) DB의 테이블을 Mapping한다.</p>\n<h3 id=\"buildgradle-1\" style=\"position:relative;\"><a href=\"#buildgradle-1\" aria-label=\"buildgradle 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>build.gradle</h3>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\"><span class=\"token comment\">//implementation 'org.springframework.boot:spring-boot-starter-jdbc'</span>\nimplementation <span class=\"token string\">'org.springframework.boot:spring-boot-starter-data-jpa'</span></code></pre></div>\n<ul>\n<li>data-jpa가 jdbc를 포함한다.</li>\n</ul>\n<h3 id=\"applicationproperties\" style=\"position:relative;\"><a href=\"#applicationproperties\" aria-label=\"applicationproperties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>application.properties</h3>\n<div class=\"gatsby-highlight\" data-language=\"properties\"><pre class=\"language-properties\"><code class=\"language-properties\"><span class=\"token comment\"># jpa가 날려주는 쿼리 보기 </span>\n<span class=\"token key attr-name\">spring.jpa.show-sql</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">true</span>\n<span class=\"token comment\"># jpa 사용 시 객체를 보고 테이블을 만들어주는데, 위에서 이미 만들었으므로 기능 끄기 (create일 시 생성)</span>\n<span class=\"token key attr-name\">spring.jpa.hibernate.ddl-auto</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">none</span></code></pre></div>\n<h3 id=\"code-classlanguage-textentitycode\" style=\"position:relative;\"><a href=\"#code-classlanguage-textentitycode\" aria-label=\"code classlanguage textentitycode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">@Entity</code></h3>\n<p>JPA가 관리하는 객체임을 알려주기 위해 객체에 어노테이션 추가한다.</p>\n<ul>\n<li>\n<p><code class=\"language-text\">@id</code></p>\n<p>PK를 명시해주자.</p>\n<p>그리고 이 경우 id를 db가 자동 생성해주고 있었다. 이름 <u><strong>identity 전략</strong></u>이라고 한다. 해당 id가 db가 자동 생성되는 것임을 명시해주자.</p>\n<p>-> <code class=\"language-text\">@GeneratedValue(strategy = GenerationType.IDENTITY)</code></p>\n</li>\n<li>\n<p><code class=\"language-text\">@Column</code></p>\n<p>객체 이름과  db의 column 이름이 다르다면 명시해주면 된다.</p>\n<p>예) <code class=\"language-text\">@Column(name = \"username\")</code></p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">IDENTITY</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"code-classlanguage-textjpamemberrepositorycode\" style=\"position:relative;\"><a href=\"#code-classlanguage-textjpamemberrepositorycode\" aria-label=\"code classlanguage textjpamemberrepositorycode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">JpaMemberRepository</code></h3>\n<p>Jpa는 <code class=\"language-text\">EntityManager</code>를 기반으로 모든 게 동작한다. 이것 역시 위에 <code class=\"language-text\">DataSource</code>처럼 스프링이 설정을 바탕으로 만들어준다. 따라서 주입받으면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">JpaMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>em <span class=\"token operator\">=</span> em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"저장하기\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>저장하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 영속화, 영구 저장</span>\n  em<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"pk값으로-객체-찾기\" style=\"position:relative;\"><a href=\"#pk%EA%B0%92%EC%9C%BC%EB%A1%9C-%EA%B0%9D%EC%B2%B4-%EC%B0%BE%EA%B8%B0\" aria-label=\"pk값으로 객체 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pk값으로 객체 찾기</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 영속화, 영구 저장</span>\n  em<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"그-외-값으로-객체-찾기\" style=\"position:relative;\"><a href=\"#%EA%B7%B8-%EC%99%B8-%EA%B0%92%EC%9C%BC%EB%A1%9C-%EA%B0%9D%EC%B2%B4-%EC%B0%BE%EA%B8%B0\" aria-label=\"그 외 값으로 객체 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그 외 값으로 객체 찾기</h3>\n<p>pk 기반이 아니므로 <u><strong>JPQL</strong></u>이라는 객체 지향 쿼리 언어를 사용해야 한다.\n테이블이 아닌 <u><strong>객체(엔티티) 를 대상으로 쿼리를 날리는 것</strong></u></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>JdbcTemplate이라면 Member로부터 id, name 등등 다 받아오고 또 객체 맵핑해주고… 이럴 필요 없이 그냥 객체를 가져올 수 있다!</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m where m.name = :name\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">setParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ? 넣어주기</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>+) 스프링 데이터 JPA는 JPA 기술을 스프링이 한 번 감싸서 제공해준다. 그 때는 findByName, findAll도 JPQL을 사용할 필요가 없다!</p>\n<h3 id=\"전체-코드\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EC%B2%B4-%EC%BD%94%EB%93%9C\" aria-label=\"전체 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전체 코드</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JpaMemberRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JpaMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>em <span class=\"token operator\">=</span> em<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        em<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> member<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m where m.name = :name\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">setParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"️-code-classlanguage-texttransactionalcode\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-code-classlanguage-texttransactionalcode\" aria-label=\"️ code classlanguage texttransactionalcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⚠️ <code class=\"language-text\">@Transactional</code></h3>\n<p>JPA를 사용할 땐(데이터를 저장하거나 변경할 때) 항상 이 어노테이션이 있어야 한다.</p>\n<p>Service 계층에 추가해주자.</p>\n<ul>\n<li>클래스 단위에 추가해줘도 되고, save 등을 하는 특정 메소드에만 추가해도 된다.</li>\n</ul>\n<h3 id=\"설정-파일\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC\" aria-label=\"설정 파일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설정 파일</h3>\n<ul>\n<li>\n<p>MemberRepository 구현체를 또 바꿔 끼울 시간이다. 이 때 EntityManager를 주입받아서 JpaMemberRepository 생성자에 넘겨주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EntityManager</span> em<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>em <span class=\"token operator\">=</span> em<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token function\">memoryMemberRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JpaMemberRepository</span><span class=\"token punctuation\">(</span>em<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n</li>\n</ul>\n<h2 id=\"-스프링-데이터-jpa\" style=\"position:relative;\"><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%8D%B0%EC%9D%B4%ED%84%B0-jpa\" aria-label=\" 스프링 데이터 jpa permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 스프링 데이터 JPA</h2>\n<blockquote>\n<p>스프링 부트와 JPA만 사용해도 개발 생산성이 정말 많이 증가하고, 개발해야할 코드도 확연히 줄어듭니다. 여기에 스프링 데이터 JPA를 사용하면, 기존의 한계를 넘어 마치 마법처럼, 리포지토리에 구현 클래스 없이 인터페이스 만으로 개발을 완료할 수 있습니다.</p>\n<ul>\n<li>어쨌든  save, find 등등의 내부 구현을 했어야 했는데..! 인터페이스만 있어도 된다.</li>\n</ul>\n<p>그리고 반복 개발해온 기본 CRUD 기능도 스프링 데이터 JPA가 모두 제공합니다. 스프링 부트와 JPA라는 기반 위에, 스프링 데이터 JPA라는 환상적인 프레임워크를 더하면 개발이 정말 즐거워집니다. 지금까지 조금이라도 단순하고 반복이라 생각했던 개발 코드들이 확연하게 줄어듭니다. 따라서 개발자는 핵심 비즈니스 로직을 개발하는데, 집중할 수 있습니다. 실무에서 관계형 데이터베이스를 사용한다면 스프링 데이터 JPA는 이제 선택이 아니라 필수 입니다.</p>\n<blockquote>\n<p>⚠️ 주의: 스프링 데이터 JPA는 JPA를 편리하게 사용하도록 도와주는 기술입니다. 따라서 JPA를 먼저 학습한 후에 스프링 데이터 JPA를 학습해야 합니다.</p>\n<p>(그래서 JPA 강의 코스도 JPA를 먼저 하고 스프링 데이터 JPA)</p>\n<p>스프링 데이터 JPA는 어디까지나 JPA를 도와주는 것이므로 JPA 자체를 모르고 사용하면 맞닥뜨리는 여러 문제를 해결할 수가 없다. 그리고 JPA를 배우고 스프링 데이터 JPA를 배우면 쉽게 배울 수 있다!</p>\n</blockquote>\n</blockquote>\n<h3 id=\"interface-1\" style=\"position:relative;\"><a href=\"#interface-1\" aria-label=\"interface 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interface</h3>\n<p>인터페이스만 만들면 구현할 게 없다 ^-^! 와!</p>\n<p>JpaRepository를 확장한 인터페이스가 있으면 이걸 읽고 알아서 스프링 빈에 프록시라는 기술을 이용해서 구현체를 만들어서 자동으로 등록해준다. 그래서 그냥 주입받으면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SpringDataJpaMemberRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">JpaRepository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MemberRepository</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p>와! 이것만 만들어놓고 구현체가 필요할 때는 주입받아서 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Autowired</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberRepository <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>기본적인  CRUD, 조회 등 공통 메소드가 다 만들어져 있다. 하지만 공통적이지 않은 것들은 당연히 공통으로 만들어 놓을 수가 없다. 그래서 interface를 만들어서 규칙을 지켜서 메소드를 만들면 된다.</p>\n<ul>\n<li>\n<p>예)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// JPQL로는 select m from Member m where m.name = ?</span>\n<span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findByName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code></pre></div>\n<p>+) <code class=\"language-text\">findByNameAndId</code> <code class=\"language-text\">findByNameOrId</code> … 등등 굉장히 많다. 웬만큼은 이걸로 해결이 된다.</p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 465px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 134.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcElEQVRIx52VB28iQQyF+f9/CYmiSCBK6CBAQOi99+7TZ+LTXEKi5UayYHdmn5+fy/i226202221j48PWS6Xwrrdb3K/3+V2u/01nn8zzvhms5lks1lJp9Py/v6uwDjZbDZqu91ODoeDGu/dPdfW67Xs93vx8efrwhubsK3X6+qwUCjIcDiU+WIu1+v1G/PL5SKr1eoByINR5pd1Pp/F5AgEApJIJGQ6ncozAiycsKeAPBgz1vF4lMNhr2HiZD6fK2Mc847/OHS/+RUQANMsk8lIMBiUcDgstVpNTqeTAhKeZ8BGoyHFYlEqlYpmvtvtqqGhJQWnngGbzabk83kpl8vS6/WESrA9W4BauXgGhBWJMC3/G5DQRqORlo3phbk16FlD1+z9ZDJRMPsQewB5ZGjdQUZhSejj8ViZUVK275khSSiVShKPxyUSiWhh+/1+fUZbK/AfNaRgdSB8Ck92qbtQKKT9TZ/HYjFtwcFgoA6xHxl+zSCJ4L2JT+mgI6HiHLOo3P5XQD5ADw7RTujmGh9aUti3yWMtiFlX6XBYLBaSSqU0JDQiRCYM4tthwoOtC/bMcKiAhNTpdDSbaGQ1uFo96pAkAGgsrCaRwMz2n85DDsCQkHFWLBa0rwndmGPuIg//ZNmdhzDt9/saajQalbe3N5Wi1WppaDYcPLce0wZNc7mcVKtV1RRpTFP72DMgTBj5hIkxLGCNI0J+eTgw9mGGZiTHMuyeewmQEJPJpLYZExuWVIEN1ZcZMuoBImyYMs4ss2Z2f3+7pKgpCtLNstWb3bWUz9cO4Z17jYKhncIB+9jMivanS9293M3A4KL/AxcXGiIeK7KsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221005014637518\"\n        title=\"image-20221005014637518\"\n        src=\"/static/29b5e4802f9426c7c547a6d98fffd8b9/9ff85/image-20221005014637518.png\"\n        srcset=\"/static/29b5e4802f9426c7c547a6d98fffd8b9/e9ff0/image-20221005014637518.png 180w,\n/static/29b5e4802f9426c7c547a6d98fffd8b9/f21e7/image-20221005014637518.png 360w,\n/static/29b5e4802f9426c7c547a6d98fffd8b9/9ff85/image-20221005014637518.png 465w\"\n        sizes=\"(max-width: 465px) 100vw, 465px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>페이징 기능도 자동으로 제공해준다</p>\n</li>\n</ul>\n<blockquote>\n<p>실무에서는 JPA와 스프링 데이터 JPA를 기본으로 사용하고, 복잡한 <u>동적 쿼리</u>는 <u>Querydsl</u>이라는 라이브러리를 사용하면 된다. Querydsl을 사용하면 쿼리도 자바 코드로 안전하게 작성할 수 있고, 동적 쿼리도 편리하게 작성할 수 있다. 이 조합으로 해결하기 어려운 쿼리는 JPA가 제공하는 <u>네이티브 쿼리</u>를 사용하거나, 앞서 학습한 <u>스프링 JdbcTemplate</u>를 사용하면 된다.</p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-%EC%8A%A4%ED%94%84%EB%A7%81-db-%EC%A0%91%EA%B7%BC-%EA%B8%B0%EC%88%A0\">☘️ 스프링 DB 접근 기술</a></p>\n<ul>\n<li>\n<p><a href=\"#-h2-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4\">📌 H2 데이터베이스</a></p>\n<ul>\n<li><a href=\"#member-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%9D%EC%84%B1\">member 테이블 생성</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%88%9C%EC%88%98-jdbc\">📌 순수 JDBC</a></p>\n<ul>\n<li><a href=\"#buildgradle\">build.gradle</a></li>\n<li><a href=\"#db-%EC%A0%95%EB%B3%B4-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">db 정보 설정하기</a></li>\n<li><a href=\"#jdbcmemberrepository\">JdbcMemberRepository</a></li>\n<li><a href=\"#ocp\">OCP</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8\">📌 스프링 통합 테스트</a></p>\n<ul>\n<li><a href=\"#springboottest\"><code class=\"language-text\">@SpringBootTest</code></a></li>\n<li><a href=\"#transactional\"><code class=\"language-text\">@Transactional</code></a></li>\n<li><a href=\"#unit-test-vs-integration-test\"><code class=\"language-text\">Unit Test</code> Vs. <code class=\"language-text\">Integration Test</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-jdbctemplate\">📌 스프링 JdbcTemplate</a></p>\n</li>\n<li>\n<p><a href=\"#-jpa-java-persistence-api\">📌 JPA: Java Persistence API</a></p>\n<ul>\n<li><a href=\"#interface\">Interface</a></li>\n<li><a href=\"#orm\">ORM</a></li>\n<li><a href=\"#buildgradle-1\">build.gradle</a></li>\n<li><a href=\"#applicationproperties\">application.properties</a></li>\n<li><a href=\"#entity\"><code class=\"language-text\">@Entity</code></a></li>\n<li><a href=\"#jpamemberrepository\"><code class=\"language-text\">JpaMemberRepository</code></a></li>\n<li><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">저장하기</a></li>\n<li><a href=\"#pk%EA%B0%92%EC%9C%BC%EB%A1%9C-%EA%B0%9D%EC%B2%B4-%EC%B0%BE%EA%B8%B0\">pk값으로 객체 찾기</a></li>\n<li><a href=\"#%EA%B7%B8-%EC%99%B8-%EA%B0%92%EC%9C%BC%EB%A1%9C-%EA%B0%9D%EC%B2%B4-%EC%B0%BE%EA%B8%B0\">그 외 값으로 객체 찾기</a></li>\n<li><a href=\"#%EC%A0%84%EC%B2%B4-%EC%BD%94%EB%93%9C\">전체 코드</a></li>\n<li><a href=\"#%EF%B8%8F-transactional\">⚠️ <code class=\"language-text\">@Transactional</code></a></li>\n<li><a href=\"#%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC\">설정 파일</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%8D%B0%EC%9D%B4%ED%84%B0-jpa\">📌 스프링 데이터 JPA</a></p>\n<ul>\n<li><a href=\"#interface-1\">Interface</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"October 04, 2022","title":"스프링 DB 접근 기술 - 스프링 입문 | 매일 1시간 👨🏻‍🏫 4일차, 5일차","categories":"강의","author":"goldggyul","emoji":null,"imageEmoji":"spring-boot-logo.png"},"fields":{"slug":"/spring-hello-005/"}},"site":{"siteMetadata":{"siteUrl":"https://goldggyul.github.io","comments":{"utterances":{"repo":"goldggyul/goldggyul.github.io"}}}}},"pageContext":{"slug":"/spring-hello-004/","nextSlug":"/spring-hello-003/","prevSlug":"/spring-hello-005/"}},"staticQueryHashes":["1956554647","2938748437","3350743975","3454833782"]}